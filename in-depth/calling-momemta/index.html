<!DOCTYPE html>
<!--[if lt IE 7 ]> <html class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Calling MoMEMta - MoMEMta</title>
      
      
      
        <link rel="canonical" href="https://momemta.github.io/in-depth/calling-momemta/">
      
      
        <meta name="author" content="The MoMEMta team">
      
    
    <meta property="og:url" content="https://momemta.github.io/in-depth/calling-momemta/">
    <meta property="og:title" content="MoMEMta">
    <meta property="og:image" content="https://momemta.github.io/in-depth/calling-momemta//../../images/logo.png">
    <meta name="apple-mobile-web-app-title" content="MoMEMta">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../images/logo.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../None">
    <link rel="icon" type="image/x-icon" href="../../None">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-4e67be2226.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-2d6c5d2926.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script src="../../assets/javascripts/modernizr-4a5cc7e01e.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-blue-grey palette-accent-teal">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                In depth <i class="icon icon-link"></i>
              
            
          </span>
        
        Calling MoMEMta
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/MoMEMta/MoMEMta" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../images/logo.png">
        </div>
      
      <div class="name">
        <strong>
          MoMEMta
          <span class="version">
            0.1.0
          </span>
        </strong>
        
          <br>
          MoMEMta/MoMEMta
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/MoMEMta/MoMEMta/archive/0.1.0.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/MoMEMta/MoMEMta/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Main" href="../..">
      Main
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="What is MoMEMta?" href="../../introduction/">
      What is MoMEMta?
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Getting started" href="../../getting-started/">
      Getting started
    </a>
    
  </li>

          
            
  <li>
    <span class="section">In depth</span>
    <ul>
      
        
  <li>
    <a class="current" title="Calling MoMEMta" href="./">
      Calling MoMEMta
    </a>
    
      
      
    
  </li>

      
        
  <li>
    <a class="" title="Configuration file" href="../configuration-file/">
      Configuration file
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Change log" href="../../changelog/">
      Change log
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <ul>
          
              
              
              <li>
                <a href="https://trello.com/b/lQXfKafM/momemta-roadmap" target="_blank" title="Roadmap">
                    Roadmap
                </a>
              </li>
          
              
              
              <li>
                <a href="https://momemta.github.io/MoMEMta/" target="_blank" title="Technical documentation">
                    Technical documentation
                </a>
              </li>
          
              
              
              <li>
                <a href="mailto:momemta-contact@cern.ch" target="_blank" title="Contact us">
                    Contact us
                </a>
              </li>
          
          </ul>
        
        
        <span class="section"><small>This work would not have been possible without the help of the MadWeight team and funding of</small></span>
        <div class="logos">
          <a href="http://www.uclouvain.be"><img src="../../assets/images/UCL-dab39722f2.png"></a>
          <a href="http://cp3.irmp.ucl.ac.be"><img src="../../assets/images/CP3-1602821e56.png"></a>
        </div>
        <div class="logos">
          <a href="http://www.frs-fnrs.be"><img src="../../assets/images/FNRS-3f43ef8877.png"></a>
          <a href="http://www.pd.infn.it/AMVA4NewPhysics"><img src="../../assets/images/AMVA4-bb51b35e33.png"></a>
        </div>
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
            <h1>Calling MoMEMta</h1>
          
          <p>In MoMEMta, the integration is defined by linking modules together in a Lua script. MoMEMta is shipped with a set of modules covering the most common needs and whose parameters, inputs and outputs are documented <a href="https://momemta.github.io/MoMEMta/group__modules.html">here</a>. For more information on how to write the configuration file, see <a href="../configuration-file/">here</a>.</p>
<blockquote>
<p><em>A module is just a C++ class deriving from the <code>Module</code> virtual class. How to write a new module and make it available for the calculation is described (here).</em></p>
</blockquote>
<p>Once the configuration file is defined, it can be loaded by MoMEMtaâ€™s configuration reader:</p>
<div class="code"><pre><span class="n">ConfigurationReader</span> <span class="nf">my_reader</span><span class="p">(</span><span class="s">&quot;relative_path_to_lua_file.lua&quot;</span><span class="p">);</span>
</pre></div>


<p>At this point, the user might wish to modify some parameters defined in the file from the code itself:</p>
<div class="code"><pre><span class="n">configuration</span><span class="p">.</span><span class="n">getGlobalParameters</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;top_mass&quot;</span><span class="p">,</span> <span class="mf">173.</span><span class="p">);</span>
</pre></div>


<p>Then, MoMEMta can be instantiated using a "frozen" configuration set:</p>
<div class="code"><pre><span class="n">Configuration</span> <span class="n">my_config</span> <span class="o">=</span> <span class="n">my_reader</span><span class="p">.</span><span class="n">freeze</span><span class="p">();</span>
<span class="n">MoMEMta</span> <span class="nf">weight</span><span class="p">(</span><span class="n">my_config</span><span class="p">);</span>
</pre></div>


<blockquote>
<p><em>MoMEMta is instantiated using a <code>Configuration</code> object, describing a fixed configuration: parameters cannot be modified at this stage. Parameters can be changed in the ConfigurationReader, and a new <code>MoMEMta</code> instance must then be constructed by calling <code>ConfigurationReader::freeze()</code> again.</em></p>
</blockquote>
<p>The weight can finally be computed by calling the computeWeights() method of the MoMEMta object, passing the observed particles as a set of LorentzVectors:</p>
<div class="code"><pre><span class="n">LorentzVector</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">met</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span> <span class="kt">double</span><span class="o">&gt;&gt;</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">weight</span><span class="p">.</span><span class="n">computeWeights</span><span class="p">({</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">},</span> <span class="n">met</span><span class="p">);</span>
</pre></div>


<blockquote>
<p><em>The MET is an optional parameter</em></p>
<p><em>The LorentzVectors are expected to be expressed in the <code>PxPyPzE&lt;double&gt;</code> basis</em></p>
</blockquote>
<p>The function starts the Monte-Carlo integration: the integrand function is called a large number of times, each time passing as input a phase-space point vector (where the length of the vector is the dimensionality of the integrated phase-space) with elements lying between 0 and 1, and returning as output the integrated function evaluated on this point.</p>
<p><code>computeWeights()</code> returns a vector of pairs (weight, uncertainty) (at the moment, this vector only has one entry) which can then be stored by the user.</p>
<blockquote>
<p><em>The phase-space points are associated with a weight, given that they are not distributed uniformly in the phase-space, but according to the importance function defined by Vegas. In most use cases this weight is not needed by the user since Cuba automatically takes it into account when computing the integral, however it can still be retrieved through the <code>cuba::ps_weight</code> input tag (see <a href="../configuration-file/#defaults">here</a>).</em></p>
</blockquote>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../../getting-started/" title="Getting started">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Getting started
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../configuration-file/" title="Configuration file">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Configuration file
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'MoMEMta/MoMEMta';
    </script>
    <script src="../../assets/javascripts/application-dfb6964a49.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
    
    
  </body>
</html>